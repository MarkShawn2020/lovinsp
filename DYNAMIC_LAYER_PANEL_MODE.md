# å›¾å±‚é¢æ¿åŠ¨æ€æ¨¡å¼åˆ‡æ¢åŠŸèƒ½

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

å›¾å±‚é¢æ¿ç°åœ¨æ”¯æŒ**å®æ—¶é”®ç›˜ç›‘å¬**ï¼Œå¯ä»¥é€šè¿‡æŒ‰é”®åŠ¨æ€åˆ‡æ¢æ“ä½œæ¨¡å¼ï¼Œæ— éœ€é¼ æ ‡ç§»åŠ¨å³å¯å“åº”ã€‚

## âœ¨ æ–°ç‰¹æ€§

### 1. **é»˜è®¤æ¨¡å¼**
- å³é”®æ‰“å¼€å›¾å±‚é¢æ¿åï¼Œé»˜è®¤æ¨¡å¼ä¸º **Copy Path**
- é¢æ¿æ ‡é¢˜æ˜¾ç¤ºï¼š`ğŸ”ï¸ Click node Â· Copy Path`

### 2. **åŠ¨æ€æ¨¡å¼åˆ‡æ¢**
- **æŒ‰ä½ Cmd é”®ï¼ˆMacï¼‰/ Ctrl é”®ï¼ˆWindowsï¼‰**
  - é¢æ¿æ ‡é¢˜ç«‹å³æ›´æ–°ä¸ºï¼š`ğŸ”ï¸ Click node Â· Open in IDE`
  - ç‚¹å‡»ä»»æ„èŠ‚ç‚¹å°†åœ¨ IDE ä¸­æ‰“å¼€æ–‡ä»¶

- **æ¾å¼€ Cmd/Ctrl é”®**
  - é¢æ¿æ ‡é¢˜æ¢å¤ä¸ºï¼š`ğŸ”ï¸ Click node Â· Copy Path`
  - ç‚¹å‡»ä»»æ„èŠ‚ç‚¹å°†å¤åˆ¶è·¯å¾„åˆ°å‰ªè´´æ¿

### 3. **å®æ—¶å“åº”**
- é”®ç›˜äº‹ä»¶ç›‘å¬å™¨åœ¨å›¾å±‚é¢æ¿æ‰“å¼€æ—¶æ¿€æ´»
- æŒ‰ä¸‹/æ¾å¼€é”®ç›˜æŒ‰é”®æ—¶ï¼Œé¢æ¿æ ‡é¢˜**ç«‹å³æ›´æ–°**
- ä¸ä¾èµ–é¼ æ ‡ç§»åŠ¨äº‹ä»¶ï¼Œç¨³å®šå¯é 

## ğŸ”§ æŠ€æœ¯å®ç°

### æ ¸å¿ƒæœºåˆ¶

#### 1. **ç‹¬ç«‹çš„é¢æ¿æ¨¡å¼çŠ¶æ€**
```typescript
@state()
layerPanelMode: InspectorAction | null = null;
```

#### 2. **é”®ç›˜äº‹ä»¶ç›‘å¬**
```typescript
handleLayerPanelKeyChange = (e: KeyboardEvent) => {
  if (!this.showNodeTree) return;

  if (this.hasModeSpecificKeys()) {
    // æ–°ç³»ç»Ÿï¼šæ ¹æ®å½“å‰æŒ‰é”®çŠ¶æ€åŠ¨æ€åˆ‡æ¢æ¨¡å¼
    this.layerPanelMode = this.getTriggeredAction(e);
  } else {
    // æ—§ç³»ç»Ÿï¼šä½¿ç”¨é»˜è®¤æ¨¡å¼
    const defaultMode = this.getDefaultAction();
    this.layerPanelMode = defaultMode === 'none' ? null : (defaultMode as InspectorAction);
  }
};
```

#### 3. **äº‹ä»¶æ³¨å†Œ**
```typescript
// åŒæ—¶ç›‘å¬ keydown å’Œ keyup äº‹ä»¶
window.addEventListener('keydown', this.handleLayerPanelKeyChange, true);
window.addEventListener('keyup', this.handleLayerPanelKeyChange, true);
```

#### 4. **é¢æ¿åˆå§‹åŒ–**
```typescript
renderLayerPanel = (nodeTree: TreeNode, { x, y }) => {
  // ... ä½ç½®è®¡ç®—

  // åˆå§‹åŒ–å›¾å±‚é¢æ¿æ¨¡å¼ï¼ˆé»˜è®¤ä¸º copyï¼‰
  const defaultMode = this.getDefaultAction();
  this.layerPanelMode = defaultMode === 'none' ? null : (defaultMode as InspectorAction);
};
```

### å…³é”®ä¼˜åŠ¿

| æ—§å®ç° | æ–°å®ç° |
|--------|--------|
| ä¾èµ–é¼ æ ‡ç§»åŠ¨æ›´æ–°çŠ¶æ€ | ç›´æ¥ç›‘å¬é”®ç›˜äº‹ä»¶ |
| é¼ æ ‡ä¸åŠ¨æ—¶çŠ¶æ€ä¸æ›´æ–° | å®æ—¶å“åº”æŒ‰é”®å˜åŒ– |
| å¯èƒ½å‡ºç°å»¶è¿Ÿæˆ–ä¸åŒæ­¥ | ç«‹å³åŒæ­¥ï¼Œç¨³å®šå¯é  |

## ğŸ“– ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1ï¼šå¿«é€Ÿåˆ‡æ¢æ¨¡å¼

1. ç”¨æˆ·å³é”®æ‰“å¼€å›¾å±‚é¢æ¿ï¼ˆæœªæŒ‰ä»»ä½•ä¿®é¥°é”®ï¼‰
2. é¢æ¿æ˜¾ç¤ºï¼š"Copy Path" æ¨¡å¼
3. ç”¨æˆ·æƒ³æ‰“å¼€ IDEï¼Œ**æŒ‰ä½ Cmd é”®**
4. é¢æ¿ç«‹å³åˆ‡æ¢ä¸ºï¼š"Open in IDE" æ¨¡å¼
5. ç‚¹å‡»èŠ‚ç‚¹ â†’ åœ¨ IDE ä¸­æ‰“å¼€
6. æ¾å¼€ Cmd é”® â†’ è‡ªåŠ¨æ¢å¤ä¸º "Copy Path" æ¨¡å¼

### åœºæ™¯ 2ï¼šç¨³å®šçš„äº¤äº’ä½“éªŒ

**ä¹‹å‰çš„é—®é¢˜ï¼š**
- å³é”®æ‰“å¼€é¢æ¿åï¼Œéœ€è¦ç§»åŠ¨é¼ æ ‡æ‰èƒ½æ›´æ–°æ¨¡å¼
- æŒ‰ä¸‹ Cmd é”®åï¼Œæ˜¾ç¤ºä¾ç„¶æ˜¯æ—§æ¨¡å¼
- ç”¨æˆ·å›°æƒ‘ï¼š"ä¸ºä»€ä¹ˆæŒ‰äº† Cmd æ²¡ååº”ï¼Ÿ"

**ç°åœ¨çš„ä½“éªŒï¼š**
- å³é”®æ‰“å¼€é¢æ¿åï¼Œæ— éœ€ç§»åŠ¨é¼ æ ‡
- æŒ‰ä¸‹/æ¾å¼€ Cmd é”®ï¼Œé¢æ¿æ ‡é¢˜**å®æ—¶æ›´æ–°**
- æ¸…æ™°ç›´è§‚ï¼Œæ‰€è§å³æ‰€å¾—

## ğŸ® å®Œæ•´çš„äº¤äº’æµç¨‹

### é»˜è®¤å¿«æ·é”®é…ç½®ï¼ˆæœªé…ç½® `behavior.keys`ï¼‰

**Mac å¹³å°ï¼š**
```
1. æŒ‰ä½ Shift + Altï¼Œå³é”®æ‰“å¼€é¢æ¿
   â†’ é»˜è®¤æ¨¡å¼ï¼šCopy Path

2. æ¾å¼€ Shiftã€Altï¼ˆå¯ä»¥æ¾å¼€ï¼ï¼‰
   â†’ é¢æ¿ä¿æŒæ‰“å¼€ï¼Œä¾ç„¶æ˜¾ç¤ºï¼šCopy Path

3. æŒ‰ä½ Cmd é”®ï¼ˆæ— éœ€ Shift/Altï¼‰
   â†’ ç«‹å³åˆ‡æ¢ä¸ºï¼šOpen in IDE

4. æ¾å¼€ Cmd é”®
   â†’ æ¢å¤ä¸ºï¼šCopy Path
```

**Windows å¹³å°ï¼š**
```
1. æŒ‰ä½ Shift + Altï¼Œå³é”®æ‰“å¼€é¢æ¿
   â†’ é»˜è®¤æ¨¡å¼ï¼šCopy Path

2. æ¾å¼€ Shiftã€Altï¼ˆå¯ä»¥æ¾å¼€ï¼ï¼‰
   â†’ é¢æ¿ä¿æŒæ‰“å¼€ï¼Œä¾ç„¶æ˜¾ç¤ºï¼šCopy Path

3. æŒ‰ä½ Ctrl é”®ï¼ˆæ— éœ€ Shift/Altï¼‰
   â†’ ç«‹å³åˆ‡æ¢ä¸ºï¼šOpen in IDE

4. æ¾å¼€ Ctrl é”®
   â†’ æ¢å¤ä¸ºï¼šCopy Path
```

**å…³é”®æ”¹è¿›ï¼š**
- âœ… é¢æ¿æ‰“å¼€å**ç‹¬ç«‹è¿è¡Œ**ï¼Œä¸ä¾èµ–åˆå§‹æŒ‰é”®çŠ¶æ€
- âœ… ç”¨æˆ·å¯ä»¥**è‡ªç”±æ¾å¼€** Shift/Altï¼Œä¸å½±å“é¢æ¿ä½¿ç”¨
- âœ… åªéœ€**æŒ‰ä¸‹ Cmd/Ctrl** å³å¯åˆ‡æ¢æ¨¡å¼ï¼Œæ— éœ€ç»„åˆé”®

### è‡ªå®šä¹‰å¿«æ·é”®é…ç½®

å¦‚æœç”¨æˆ·é…ç½®äº† `behavior.keys`ï¼š

```typescript
behavior: {
  copy: true,
  locate: true,
  keys: {
    copy: ['shiftKey', 'altKey'],
    locate: ['shiftKey', 'altKey', 'metaKey']
  }
}
```

**äº¤äº’æµç¨‹ï¼š**
```
1. å³é”®æ‰“å¼€é¢æ¿ï¼ˆé»˜è®¤æŒ‰ä½ Shift+Altï¼‰
   â†’ é»˜è®¤æ¨¡å¼ï¼šCopy Path

2. ç»§ç»­æŒ‰ä¸‹ Cmd é”®ï¼ˆç°åœ¨æ˜¯ Shift+Alt+Cmdï¼‰
   â†’ åˆ‡æ¢ä¸ºï¼šOpen in IDE

3. æ¾å¼€ Cmd é”®ï¼ˆæ¢å¤ä¸º Shift+Altï¼‰
   â†’ æ¢å¤ä¸ºï¼šCopy Path
```

## ğŸ” è°ƒè¯•ä¸éªŒè¯

### éªŒè¯æ¨¡å¼åˆ‡æ¢

æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ŒæŸ¥çœ‹ `layerPanelMode` çŠ¶æ€ï¼š

```javascript
const inspector = document.querySelector('code-inspector-component');

// æ‰“å¼€å›¾å±‚é¢æ¿åï¼ŒæŸ¥çœ‹å½“å‰æ¨¡å¼
console.log('Current layer panel mode:', inspector.layerPanelMode);

// æŒ‰ä¸‹ Cmd é”®åå†æ¬¡æŸ¥çœ‹
console.log('After pressing Cmd:', inspector.layerPanelMode);
```

### é¢„æœŸè¾“å‡º

```
Initial state: layerPanelMode = "copy"
Press Cmd: layerPanelMode = "locate"
Release Cmd: layerPanelMode = "copy"
```

## ğŸ› å·²è§£å†³çš„é—®é¢˜

### é—®é¢˜ 1ï¼šæ¨¡å¼åˆ‡æ¢ä¸ç¨³å®š

**ç—‡çŠ¶ï¼š** å³ä½¿æŒ‰ä¸‹ Cmd é”®ï¼Œæ˜¾ç¤ºä¾ç„¶æ˜¯ "Copy Path"

**æ ¹æœ¬åŸå› ï¼š** ä¾èµ– `mousemove` äº‹ä»¶æ›´æ–° `currentTriggeredAction`ï¼Œå›¾å±‚é¢æ¿æ‰“å¼€åé¼ æ ‡ä¸åŠ¨å°±ä¸ä¼šæ›´æ–°

**è§£å†³æ–¹æ¡ˆï¼š** æ–°å¢ç‹¬ç«‹çš„ `layerPanelMode` çŠ¶æ€ï¼Œç›´æ¥ç›‘å¬ `keydown` å’Œ `keyup` äº‹ä»¶

### é—®é¢˜ 2ï¼šç”¨æˆ·ä½“éªŒä¸ç›´è§‚

**ç—‡çŠ¶ï¼š** ç”¨æˆ·æŒ‰ä¸‹ Cmd åéœ€è¦ç§»åŠ¨é¼ æ ‡æ‰èƒ½çœ‹åˆ°æ¨¡å¼å˜åŒ–

**æ ¹æœ¬åŸå› ï¼š** çŠ¶æ€æ›´æ–°é€»è¾‘åœ¨ `handleMouseMove` ä¸­

**è§£å†³æ–¹æ¡ˆï¼š** åœ¨ `handleLayerPanelKeyChange` ä¸­å®æ—¶æ›´æ–°ï¼Œæ— éœ€é¼ æ ‡ç§»åŠ¨

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### äº‹ä»¶è¿‡æ»¤

```typescript
handleLayerPanelKeyChange = (e: KeyboardEvent) => {
  if (!this.showNodeTree) return; // é¢æ¿æœªæ‰“å¼€æ—¶ä¸å¤„ç†
  // ...
};
```

**ä¼˜åŠ¿ï¼š**
- ä»…åœ¨å›¾å±‚é¢æ¿æ‰“å¼€æ—¶å¤„ç†é”®ç›˜äº‹ä»¶
- é¿å…ä¸å¿…è¦çš„è®¡ç®—å’ŒçŠ¶æ€æ›´æ–°
- æ€§èƒ½å¼€é”€å¯å¿½ç•¥ä¸è®¡

## ğŸ‰ ç”¨æˆ·åé¦ˆæ”¹è¿›

åŸºäºç”¨æˆ·å»ºè®®ï¼š
> "æ—¢ç„¶cmd+shift+å³é”®æ‰“å¼€åæ˜¯ä¸€ä¸ªå›ºå®šçš„æ‚¬æµ®çª—ï¼Œé‚£æˆ‘ä»¬å¯ä»¥è€ƒè™‘ç›‘å¬cmdé”®ï¼Œé»˜è®¤æ˜¯copy pathï¼ŒæŒ‰ä½cmdå°±æ‰“å¼€"

**å®ç°è¦ç‚¹ï¼š**
1. âœ… å›¾å±‚é¢æ¿ç¡®å®æ˜¯å›ºå®šæ‚¬æµ®çª—
2. âœ… é»˜è®¤æ¨¡å¼ä¸º Copy Path
3. âœ… æŒ‰ä½ Cmd/Ctrl é”®åˆ‡æ¢ä¸º Open in IDE
4. âœ… æ¾å¼€é”®ç›˜æ¢å¤é»˜è®¤æ¨¡å¼
5. âœ… æ— éœ€é¼ æ ‡ç§»åŠ¨å³å¯å“åº”
6. âœ… å®æ—¶æ›´æ–°é¢æ¿æ ‡é¢˜

## ç›¸å…³æ–‡ä»¶

- `packages/core/src/client/index.ts:172` - `layerPanelMode` çŠ¶æ€å®šä¹‰
- `packages/core/src/client/index.ts:557-568` - `handleLayerPanelKeyChange` å®ç°
- `packages/core/src/client/index.ts:1158-1159` - é”®ç›˜äº‹ä»¶æ³¨å†Œ
- `packages/core/src/client/index.ts:1423-1425` - é¢æ¿æ ‡é¢˜åŠ¨æ€æ˜¾ç¤º

## ä¸‹ä¸€æ­¥ä¼˜åŒ–å»ºè®®

1. **è§†è§‰åé¦ˆå¢å¼º**
   - è€ƒè™‘æ·»åŠ åŠ¨ç”»æ•ˆæœï¼Œè®©æ¨¡å¼åˆ‡æ¢æ›´æ˜æ˜¾
   - ä¾‹å¦‚ï¼šæ ‡é¢˜æ–‡å­—é¢œè‰²å˜åŒ–æˆ–å›¾æ ‡åŠ¨ç”»

2. **å¿«æ·é”®æç¤º**
   - åœ¨é¢æ¿åº•éƒ¨æ˜¾ç¤ºï¼š"Press Cmd to switch mode"
   - æŒ‰ä¸‹ Cmd åæ˜¾ç¤ºï¼š"Release Cmd to restore"

3. **å¤šç§æ¨¡å¼æ”¯æŒ**
   - å¦‚æœé…ç½®äº† 3 ç§ä»¥ä¸Šæ“ä½œï¼Œå¯ä»¥è€ƒè™‘å¾ªç¯åˆ‡æ¢
   - ä¾‹å¦‚ï¼šCmd â†’ locateï¼ŒCtrl â†’ targetï¼Œé»˜è®¤ â†’ copy
